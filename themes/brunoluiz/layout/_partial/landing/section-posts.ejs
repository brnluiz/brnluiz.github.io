<%
let choosen_colours = [];
let max_colours = 5;
let getRandomColour = (min, max) => {
  let random = Math.floor(Math.random() * (max - min + 1)) + min;

  // Reset colour arrays if it reached the maximum colour range
  if(choosen_colours.length == max_colours)
    choosen_colours = [];

  // Avoid repeated colours for the defined number of max_colours
  if (choosen_colours.indexOf(random) != -1)
    return getRandomColour(min,max);

  // Just record which colour was gotten, duh
  choosen_colours.push(random);
  return random;
}

let posts = site.categories
.findOne({name: 'web'})
.posts.limit(3);

posts.each((post) => {
  let featured_image = url_for(post.permalink + post.photos[0]);
  let bg_colour = "colourset-"+getRandomColour(0,max_colours);
  %>
  <div class='column'>
    <div class='thumb-item'>
      <div class='content-bg' style='background-image: url("<%=featured_image%>")'></div>
      <a href='<%= url_for(post.path) %>' class='<%=bg_colour%>'></a>
      <div class='title'><%=post.title%></div>
    </div>
  </div>
<%  }); %>

<% if (posts.length > 3) { %>
  <div class='row column see-more'>
    <a class='secondary hollow button' href='#'>See more <%=title%> projects</a>
  </div>
<% } %>
